# 基于UDP模拟的可靠数据传输协议

## 简介

使用Java的UDP Socket模拟的可靠数据传输协议。

支持：

* 传输任意文件
* 保证数据按序到达，不会丢失
* 可以在一个Socket上实现双向传输、同时上传和下载

---

## 架构

提供三种可靠数据传输协议：

* `RDT`：可靠数据传输协议的抽象接口
  * `SAW`：简单停等协议
  * `GBN`：回退N步协议
  * `SR`：选择重传协议

使用工厂模式，由协议类调用`createSender()`和`createReceiver`创建与之绑定的发送方和接收方类：`Sender`和`Receiver`。这两个同样是接口，有各自对应协议的实现类。

此外还提供文件传输应用的C/S类。

* `FileClient`：“客户端”线程。负责：
  * 等待用户输入指令
  * 读取文件，划分数据包
  * 调用`Sender`发送数据包
* `FileServer`：“服务端”线程。负责：
  * 等待接收传来的数据/ACK
  * 将数据/ACK分流，分别交给`Receiver`或者`Sender`
  * 发送ACK（实际上在接收数据时由`Receiver`自动完成）
  * 将接收的文件写入

不论是文件的发送者还是接收者，两个线程都需要同时执行。

---

## 使用说明

分别启动CS01和CS02。它们两个的文件区在`src/main/resources`下。

选择一个控制台，比如CS01，输入：

```
-sendFile test01.jpg
```

即可传输CS01的文件test01.jpg。若想传输其他文件，需要在文件区中添加文件，并更改指令中的文件名即可。

想要更换协议，则只需同时在CS01和CS02的第29行：

```
rdt = new SR();
```

将此处的`SR`修改为`GBN`或者`SAW`即可。之后Java会利用子类型多态自动导入相关协议。但要注意，**一定要保证CS01和CS02使用同一协议**。

使用不同协议传输，可以明显看到输出的不同。

---